#pragma once
#include "Effect.h"

namespace HyEngine
{
	class ENGINE_DLL MeshEffect : public Effect
	{
		//////////////////////////////////////////////////////////////////////////
		// CONSTRUCTOR & DESTRUCTOR
		//////////////////////////////////////////////////////////////////////////
	protected :
		explicit MeshEffect(Scene* scene, int editID);
		explicit MeshEffect(Scene* scene);
		virtual ~MeshEffect();

		//////////////////////////////////////////////////////////////////////////
		// INHERITED
		//////////////////////////////////////////////////////////////////////////
	public :
		virtual void OnEnable() override;
		virtual void OnDisable() override;
		virtual void Update() override;
		virtual void Render() override;
		virtual void DrawPrimitive(ID3DXEffect * pEffect) override;
		virtual void UpdatedData(EDataType dataType)override;


		//////////////////////////////////////////////////////////////////////////
		// INITIALIZER
		//////////////////////////////////////////////////////////////////////////
	private :
		void Initialize();

		//////////////////////////////////////////////////////////////////////////
		// SETTER
		//////////////////////////////////////////////////////////////////////////
	public: /* Resource */
		void SetDiffuseTexture(std::wstring path);
		void SetAlphaMaskTexture(std::wstring path);
		void SetNormalMapTexture(std::wstring path);
		void SetEffectMesh(std::wstring path);

		//////////////////////////////////////////////////////////////////////////
		// GETTER
		//////////////////////////////////////////////////////////////////////////
	public :
		ID3DXMesh* GetMesh() const;
		IDirect3DTexture9* GetDiffuseTexture() const;
		IDirect3DTexture9* GetNormalTexture() const;
		IDirect3DTexture9* GetAlphaMaskTexture() const;


		//////////////////////////////////////////////////////////////////////////
		// VARIABLES
		//////////////////////////////////////////////////////////////////////////
	private :
		ID3DXMesh* m_pMesh = nullptr;
		IDirect3DTexture9 * m_pDiffuseMap = nullptr;
		IDirect3DTexture9 * m_pNormalMap = nullptr;
		IDirect3DTexture9 * m_pAlphaMask = nullptr;

	private : /* For mesh */
		std::wstring m_lastMeshPath;


		//////////////////////////////////////////////////////////////////////////
		// FACTORY METHOD
		//////////////////////////////////////////////////////////////////////////
	public :
		static MeshEffect* Create(Scene* scene);
		static MeshEffect* Create(Scene* scene, int editID);
	};
}

